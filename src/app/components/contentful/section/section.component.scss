@use "_v3/calc" as calc;

$h: '' !default;
$init: (
  text-widget-custom-margin-y: (media-query-up: (
    xs: var(--#{calc.$cb}space-600),
    lg: var(--#{calc.$cb}space-700),
    xl: var(--#{calc.$cb}space-900),
  )),
  text-widget-margin-top: (media-query-up: (
    xs: calc((var(--#{$h}text-widget-custom-margin-y) - var(--#{calc.$cb}cst-header-gap)) * -1),
  )),
  widget-item-font-size: (media-query-up: (
    xs: var(--#{calc.$cb}font-size-lg),
    lg: var(--#{calc.$cb}font-size-125),
  )),
  widget-resources-columns: (media-query-up: (
    xs: 1fr,
    md: repeat(2, minmax(200px, 1fr)),
  )),
  widget--image-tile-break-w: (media-query-up: (
    xs: calc(100dvw - (var(--#{calc.$cb}container-margin) * 2)),
    xl: calc(var(--#{calc.$cb}container-max-width-query) - (var(--#{calc.$cb}container-max-width-query) / 12 * 2) - (var(--#{calc.$cb}container-margin) * 2)),
  )),
) !default;

:host {
  @include calc.css-initVars($init, $h);


  ::ng-deep {
    p,
    h1,
    h2,
    h3,
    h4 {
      &:not(.title) {
        & + br {
          display: none;
        }

        &:last-child {
          margin-bottom: 0;
        }
      }
    }


    .accordion-widget {
      .mat-expansion-panel {
        .mat-expansion-panel-header {
          .mat-content {
            .mat-expansion-panel-header-title {
              > div {
                > div {
                  margin: 0 !important;
                }
              }
            }
          }
        }
      }
    }
  }

  ::ng-deep {
    .cst.cst--custom {
      //&:not(.cst--without-title ) {
      //  .widget-container {
      //    & > *:first-child {
      //      &.widget--text {
      //        //margin-top: var(--#{$h}text-widget-margin-top);
      //      }
      //    }
      //  }
      //}

      &.cst--empty-content {
        .widget--text {
          --#{$h}text-widget-margin-top: var(--#{calc.$cb}space-300);
        }
      }
    }

    .widgets--resources {
      display: grid;
      grid-template-columns:var(--#{$h}widget-resources-columns);
      column-gap: var(--#{calc.$cb}space-600);
      row-gap: var(--#{calc.$cb}cst-offset-y-sm);

    }

    .widget--text {
      .text-wrapper {
        p {
          font-size: var(--#{$h}widget-item-font-size);
        }
      }
    }
  }


  .widget-container {

    > * {
      & + * {
        display: block;
        margin-top: var(--#{calc.$cb}cst-in-margin-y);

        &.widget--navbar {
          margin-top: var(--#{calc.$cb}cst-contnet-offset-y);
        }
      }
    }


    .widget--image-tile + .widget--image-tile {
      display: block;
      position:relative;
      margin-top: var(--#{calc.$cb}cst-in-margin-y);
      padding-top: var(--#{calc.$cb}cst-in-margin-y);
      &:before {
        content: '';
        display:block;
        position: absolute;
        top: -1px;
        left: 50%;
        transform: translateX(-50%);
        width: var(--#{$h}widget--image-tile-break-w);
        border-top: 2px solid var(--#{calc.$color}neutral-base-020);
      }

    }

    .widget--text + .widget--accordion {
      margin-top: var(--#{calc.$cb}cst-contnet-offset-y);
    }

    .widget--accordion + .widget--accordion {
      margin-top: 0 !important;
    }


    &:has(lilly-image-link-widget) {
      text-align: center;
    }

    lilly-image-link-widget {
      display: inline-block !important;
    }
  }
}
