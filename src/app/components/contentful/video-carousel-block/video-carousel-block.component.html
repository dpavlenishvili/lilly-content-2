<div class="video-carousel-block">
  <!-- Header Section -->
  <div class="video-carousel-block__header">
    @if (fields()?.label) {
      <div class="video-carousel-block__label">{{ fields()?.label }}</div>
    }
    <h1 class="video-carousel-block__title">
      {{ fields()?.title }}
    </h1>
    @if (fields()?.subtitle) {
      <p class="video-carousel-block__subtitle">{{ fields()?.subtitle }}</p>
    }
  </div>

  <!-- Filter Tabs and CTA Row -->
  <div class="video-carousel-block__controls">
    <!-- Desktop Category Filter Pills -->
    @if (fields()?.categoryTabs?.length) {
      <div class="is-nav-desktop">
        <div class="filter-pills">
          <!-- Category pills -->
          @for (tab of fields()?.categoryTabs; track tab.sys.id) {
            <button
              class="filter-pills__item"
              [class.is-active]="selectedCategory() === tab.fields.filterValue"
              (click)="onCategoryClick(tab)">
              {{ tab.fields.label }}
            </button>
          }
        </div>
      </div>

      <!-- Mobile Category Dropdown -->
      <div class="is-nav-mobile">
        <mat-form-field class="category-dropdown">
          <mat-select [value]="selectedCategory()" (selectionChange)="selectedCategory.set($event.value)">
            @for (tab of fields()?.categoryTabs; track tab.sys.id) {
              <mat-option [value]="tab.fields.filterValue">{{ tab.fields.label }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      </div>
    }

    <!-- CTA Button -->
    @if (fields()?.ctaButton?.fields) {
      <button
        class="return-home-btn"
        (click)="onCtaClick()">
        {{ fields()?.ctaButton?.fields?.text }}
        <mat-icon>arrow_back</mat-icon>
      </button>
    }
  </div>

  <!-- Video Cards Carousel -->
  <div class="video-carousel-block__wrapper">
    <div class="video-carousel" #carousel>
      @for (video of filteredVideos(); track video.sys.id) {
        <div
          class="video-card"
          (click)="onVideoClick(video)"
          (keydown.enter)="onVideoClick(video)"
          tabindex="0"
          role="button"
          [attr.aria-label]="'Play video: ' + video.fields.title">

          <!-- Category Label -->
          <div class="video-card__category">{{ video.fields.categoryLabel }}</div>

          <!-- Background Image -->
          <img
            class="video-card__image"
            [src]="video.fields.thumbnail.fields.file.url"
            [alt]="video.fields.title"
            loading="lazy"
            decoding="async" />

          <!-- Card Footer -->
          <div class="video-card__footer">
            <!-- Title with Icon -->
            <div class="video-card__title">
              @if (video.fields.icon?.fields?.file?.url) {
                <img
                  class="video-card__icon"
                  [src]="video.fields.icon.fields.file.url"
                  alt=""
                  loading="lazy" />
              }
              <span>{{ video.fields.title }}</span>
            </div>

            <!-- Play Button -->
            <button class="video-card__play-btn" aria-label="Play video">
              <mat-icon>play_arrow</mat-icon>
            </button>
          </div>
        </div>
      }
    </div>

    <!-- Navigation Arrow (Desktop Only) -->
    @if (filteredVideos().length > 3) {
      <button
        class="carousel-nav carousel-nav--next"
        (click)="scrollCarousel('next')"
        aria-label="Next videos">
        <mat-icon>chevron_right</mat-icon>
      </button>
    }
  </div>
</div>
